include(conan-profile-common)

[settings]
os=Macos
# 14.2 is required by opensubdiv for metal
os.version=14.2
arch=armv8
compiler=apple-clang
compiler.version=17
compiler.cppstd={{ os.getenv("CXX_VERSION") }}
compiler.libcxx=libc++

[options]
boost/*:without_stacktrace=True
boost/*:without_locale=True
minizip-ng/*:with_zlib=True
minizip-ng/*:with_libcomp=False
embree/*:shared=True
opensubdiv/*:with_metal=True

[buildenv]
PKG_ARCH=armv8
# 14.2 is required by opensubdiv for metal
# See also macos_var.cmake
MACOSX_DEPLOYMENT_TARGET=14.2
VERBOSE=1

[conf]
&:tools.build:cxxflags+=["-O3"]
tools.cmake.cmaketoolchain:user_toolchain+={{profile_dir}}/macos-vars-ARM64.cmake

openvdb/*:tools.build:cxxflags+=["-Wno-error", "-Wno-missing-template-arg-list-after-template-kw"]

# vim: ft=conf
